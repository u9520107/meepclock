"use strict";var _regeneratorRuntime=require("babel-runtime/regenerator")["default"],_interopRequire=require("babel-runtime/helpers/interop-require")["default"],_interopRequireWildcard=require("babel-runtime/helpers/interop-require-wildcard")["default"],koa=_interopRequire(require("koa")),router=_interopRequire(require("koa-router")),favicon=_interopRequire(require("koa-favicon")),mount=_interopRequire(require("koa-mount")),serve=_interopRequire(require("koa-static-cache")),path=_interopRequire(require("path")),config=_interopRequireWildcard(require("./config")),debug=_interopRequire(require("debug"));debug.enable("server-log");var log=debug("server-log"),RequireFilter=_interopRequire(require("meepworks/require-filter")),requireFilter=new RequireFilter({fileRoot:__dirname,urlRoot:"/build",version:config.version});requireFilter.filter(".css!"),requireFilter.filter(".mp3!"),requireFilter.filter(".*!asset");var MeepClock=_interopRequire(require("./app/app")),AppDriver=_interopRequire(require("meepworks/server-app-driver")),server=koa(),port=process.env.PORT||13352;server.use(favicon()),server.use(mount("/build",serve(path.resolve(__dirname,"../build/"),{maxAge:3e5,dynamic:!0}))),server.use(mount("/bundle",serve(path.resolve(__dirname,"../bundle/"),{maxAge:3e5,dynamic:!0}))),server.use(mount("/jspm_packages",serve(path.resolve(__dirname,"../jspm_packages/"),{maxAge:3e5,dynamic:!0}))),server.use(_regeneratorRuntime.mark(function e(r){var i,t=this;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Date,e.next=3,r;case 3:log(t.req.url,""+((new Date).getTime()-i.getTime())+" ms");case 4:case"end":return e.stop()}},e,this)})),server.use(mount("/",new AppDriver(MeepClock,{appPath:"app/app",jspm:{path:"jspm_packages",config:"jspm_packages/config.js"},distPath:{external:"build",internal:"build"},fileRoot:__dirname,debug:config.debug,version:config.version}))),server.listen(port,function(){log("listening to "+port)});